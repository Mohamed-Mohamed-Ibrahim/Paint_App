{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.array.push.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DD = void 0;\nconst Global_1 = require(\"./Global\");\nconst Util_1 = require(\"./Util\");\nexports.DD = {\n  get isDragging() {\n    var flag = false;\n    exports.DD._dragElements.forEach(elem => {\n      if (elem.dragStatus === 'dragging') {\n        flag = true;\n      }\n    });\n    return flag;\n  },\n  justDragged: false,\n  get node() {\n    var node;\n    exports.DD._dragElements.forEach(elem => {\n      node = elem.node;\n    });\n    return node;\n  },\n  _dragElements: new Map(),\n  _drag(evt) {\n    const nodesToFireEvents = [];\n    exports.DD._dragElements.forEach((elem, key) => {\n      const {\n        node\n      } = elem;\n      const stage = node.getStage();\n      stage.setPointersPositions(evt);\n      if (elem.pointerId === undefined) {\n        elem.pointerId = Util_1.Util._getFirstPointerId(evt);\n      }\n      const pos = stage._changedPointerPositions.find(pos => pos.id === elem.pointerId);\n      if (!pos) {\n        return;\n      }\n      if (elem.dragStatus !== 'dragging') {\n        var dragDistance = node.dragDistance();\n        var distance = Math.max(Math.abs(pos.x - elem.startPointerPos.x), Math.abs(pos.y - elem.startPointerPos.y));\n        if (distance < dragDistance) {\n          return;\n        }\n        node.startDrag({\n          evt\n        });\n        if (!node.isDragging()) {\n          return;\n        }\n      }\n      node._setDragPosition(evt, elem);\n      nodesToFireEvents.push(node);\n    });\n    nodesToFireEvents.forEach(node => {\n      node.fire('dragmove', {\n        type: 'dragmove',\n        target: node,\n        evt: evt\n      }, true);\n    });\n  },\n  _endDragBefore(evt) {\n    const drawNodes = [];\n    exports.DD._dragElements.forEach(elem => {\n      const {\n        node\n      } = elem;\n      const stage = node.getStage();\n      if (evt) {\n        stage.setPointersPositions(evt);\n      }\n      const pos = stage._changedPointerPositions.find(pos => pos.id === elem.pointerId);\n      if (!pos) {\n        return;\n      }\n      if (elem.dragStatus === 'dragging' || elem.dragStatus === 'stopped') {\n        exports.DD.justDragged = true;\n        Global_1.Konva._mouseListenClick = false;\n        Global_1.Konva._touchListenClick = false;\n        Global_1.Konva._pointerListenClick = false;\n        elem.dragStatus = 'stopped';\n      }\n      const drawNode = elem.node.getLayer() || elem.node instanceof Global_1.Konva['Stage'] && elem.node;\n      if (drawNode && drawNodes.indexOf(drawNode) === -1) {\n        drawNodes.push(drawNode);\n      }\n    });\n    drawNodes.forEach(drawNode => {\n      drawNode.draw();\n    });\n  },\n  _endDragAfter(evt) {\n    exports.DD._dragElements.forEach((elem, key) => {\n      if (elem.dragStatus === 'stopped') {\n        elem.node.fire('dragend', {\n          type: 'dragend',\n          target: elem.node,\n          evt: evt\n        }, true);\n      }\n      if (elem.dragStatus !== 'dragging') {\n        exports.DD._dragElements.delete(key);\n      }\n    });\n  }\n};\nif (Global_1.Konva.isBrowser) {\n  window.addEventListener('mouseup', exports.DD._endDragBefore, true);\n  window.addEventListener('touchend', exports.DD._endDragBefore, true);\n  window.addEventListener('mousemove', exports.DD._drag);\n  window.addEventListener('touchmove', exports.DD._drag);\n  window.addEventListener('mouseup', exports.DD._endDragAfter, false);\n  window.addEventListener('touchend', exports.DD._endDragAfter, false);\n}","map":{"version":3,"names":["require","Object","defineProperty","exports","value","DD","Global_1","Util_1","isDragging","flag","_dragElements","forEach","elem","dragStatus","justDragged","node","Map","_drag","evt","nodesToFireEvents","key","stage","getStage","setPointersPositions","pointerId","undefined","Util","_getFirstPointerId","pos","_changedPointerPositions","find","id","dragDistance","distance","Math","max","abs","x","startPointerPos","y","startDrag","_setDragPosition","push","fire","type","target","_endDragBefore","drawNodes","Konva","_mouseListenClick","_touchListenClick","_pointerListenClick","drawNode","getLayer","indexOf","draw","_endDragAfter","delete","isBrowser","window","addEventListener"],"sources":["C:/Users/Al-Gawad/node_modules/konva/lib/DragAndDrop.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DD = void 0;\nconst Global_1 = require(\"./Global\");\nconst Util_1 = require(\"./Util\");\nexports.DD = {\n    get isDragging() {\n        var flag = false;\n        exports.DD._dragElements.forEach((elem) => {\n            if (elem.dragStatus === 'dragging') {\n                flag = true;\n            }\n        });\n        return flag;\n    },\n    justDragged: false,\n    get node() {\n        var node;\n        exports.DD._dragElements.forEach((elem) => {\n            node = elem.node;\n        });\n        return node;\n    },\n    _dragElements: new Map(),\n    _drag(evt) {\n        const nodesToFireEvents = [];\n        exports.DD._dragElements.forEach((elem, key) => {\n            const { node } = elem;\n            const stage = node.getStage();\n            stage.setPointersPositions(evt);\n            if (elem.pointerId === undefined) {\n                elem.pointerId = Util_1.Util._getFirstPointerId(evt);\n            }\n            const pos = stage._changedPointerPositions.find((pos) => pos.id === elem.pointerId);\n            if (!pos) {\n                return;\n            }\n            if (elem.dragStatus !== 'dragging') {\n                var dragDistance = node.dragDistance();\n                var distance = Math.max(Math.abs(pos.x - elem.startPointerPos.x), Math.abs(pos.y - elem.startPointerPos.y));\n                if (distance < dragDistance) {\n                    return;\n                }\n                node.startDrag({ evt });\n                if (!node.isDragging()) {\n                    return;\n                }\n            }\n            node._setDragPosition(evt, elem);\n            nodesToFireEvents.push(node);\n        });\n        nodesToFireEvents.forEach((node) => {\n            node.fire('dragmove', {\n                type: 'dragmove',\n                target: node,\n                evt: evt,\n            }, true);\n        });\n    },\n    _endDragBefore(evt) {\n        const drawNodes = [];\n        exports.DD._dragElements.forEach((elem) => {\n            const { node } = elem;\n            const stage = node.getStage();\n            if (evt) {\n                stage.setPointersPositions(evt);\n            }\n            const pos = stage._changedPointerPositions.find((pos) => pos.id === elem.pointerId);\n            if (!pos) {\n                return;\n            }\n            if (elem.dragStatus === 'dragging' || elem.dragStatus === 'stopped') {\n                exports.DD.justDragged = true;\n                Global_1.Konva._mouseListenClick = false;\n                Global_1.Konva._touchListenClick = false;\n                Global_1.Konva._pointerListenClick = false;\n                elem.dragStatus = 'stopped';\n            }\n            const drawNode = elem.node.getLayer() ||\n                (elem.node instanceof Global_1.Konva['Stage'] && elem.node);\n            if (drawNode && drawNodes.indexOf(drawNode) === -1) {\n                drawNodes.push(drawNode);\n            }\n        });\n        drawNodes.forEach((drawNode) => {\n            drawNode.draw();\n        });\n    },\n    _endDragAfter(evt) {\n        exports.DD._dragElements.forEach((elem, key) => {\n            if (elem.dragStatus === 'stopped') {\n                elem.node.fire('dragend', {\n                    type: 'dragend',\n                    target: elem.node,\n                    evt: evt,\n                }, true);\n            }\n            if (elem.dragStatus !== 'dragging') {\n                exports.DD._dragElements.delete(key);\n            }\n        });\n    },\n};\nif (Global_1.Konva.isBrowser) {\n    window.addEventListener('mouseup', exports.DD._endDragBefore, true);\n    window.addEventListener('touchend', exports.DD._endDragBefore, true);\n    window.addEventListener('mousemove', exports.DD._drag);\n    window.addEventListener('touchmove', exports.DD._drag);\n    window.addEventListener('mouseup', exports.DD._endDragAfter, false);\n    window.addEventListener('touchend', exports.DD._endDragAfter, false);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}